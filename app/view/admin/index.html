<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/plupload/2.1.9/plupload.full.min.js"></script>
    <script src="/public/static/qiniu.js"></script>
  </head>
  <body>
    <div class="form-field"><Button id='pickfiles'>上传图片</Button></div>
    <script>
      const token = 'R7wrNwfn9V9Rqtdc0aX-xOkNxFNSofiyj3Jh-o_e:II9jOTYSdcfZHmX0_bbbBl-I180=:eyJzY29wZSI6InZpcmdpbm1hcnkiLCJkZWFkbGluZSI6MTU0ODU3MDIxMH0='
      Qiniu.uploader({
        runtimes: 'html5,flash,html4',
        browse_button: 'pickfiles',
        flash_swf_url: 'https://cdn.bootcss.com/plupload/2.1.1/Moxie.swf',
        chunk_size: '2mb',
        uptoken: token,
        save_key: false,
        unique_names: false,
        // uptoken_url: 'http://jssdk.demo.qiniu.io/uptoken',
        domain: 'plge4pwnk.bkt.clouddn.com',
        get_new_uptoken: true,
        auto_start: true,
        max_retries: 3,
        filters: {
          max_file_size: '10000mb',
          prevent_duplicates: false,
          // 只允许上传图片
          // mime_types: [{ title: 'Image files', extensions: 'jpg,jpeg,gif,png' }]
        },
        init: {
          FilesAdded: (up, files) => {
            // const fileItem = files[0].getNative()
            // const url = window.URL
            // this.setState({ thumb: url.createObjectURL(fileItem) })
          },
          BeforeUpload: (up, file) => {
            console.log('上传之前', file)
          },
          UploadProgress: (up, file) => {
            console.log('上传中 file', file)
          },
          FileUploaded: (up, file, info) => {
            console.log('文件上传完毕', info)
          },
          Error: (up, err, errTip) => {
            console.log('上传失败', err)
          },
          Key: (up, file) => {
            // 若想在前端对每个文件的key进行个性化处理，可以配置该函数
            // 该配置必须要在unique_names: false，save_key: false时才生效
            // const ext = Qiniu.getFileExtension(file.name)
            // const key = `${list.newkey}/${name}.${ext}`

            // this.setState({ PicPath_0: key })
            // return key
          }
        }
      })
    </script>
  </body>
</html>
